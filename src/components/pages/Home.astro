---
import { marked } from 'marked';
import { z } from 'astro:content';
import Layout from '@layouts/Layout.astro';
import Button from '@preact/Button.tsx';
import Title from '@components/typography/Title.astro';

import data from '@content/home.json';

interface Props {
  locale: 'en' | 'de';
}

const { locale } = Astro.props as Props;

const multiLingualSchema = (schema: z.Schema) =>
  z.object({
    en: schema,
    de: schema,
  });

const contentSchema = multiLingualSchema(
  z.object({
    title: z.string(),
    intro: z.string(),
  }),
);

const parsedData = contentSchema.parse(data);

const { en, de } = parsedData;

const content = locale === 'en' ? en : de;

const markdown = content.intro;
const markdownContent = marked.parse(markdown);

const title = 'English-Rafzerfeld';
---

<Layout title={title} locale={locale}>
  <Title>{content.title}</Title>
  <div class="markdown" set:html={markdownContent} />
  <Button title="Click Me" client:load />
</Layout>
