---
import { z } from 'astro:content';
import Map from '@components/Map.astro';

import { multiLingualSchema } from '@utils/zod.ts';
import { getLocaleData, getLocaleFromURL } from '@utils/locale.ts';

import data from '@content/contact.json';

const locale = getLocaleFromURL(Astro.url);

const contentSchema = multiLingualSchema(
  z.object({
    title: z.string(),
    description: z.string(),
    email: z.string().email(),
    teachersContact: z.array(
      z.object({
        name: z.string(),
        email: z.string().email(),
        phone: z.string(),
      }),
    ),
    address: z.string(),
  }),
);

const parsedData = contentSchema.parse(data);

const content = getLocaleData(locale, parsedData);
---

<div id="contact" class="mt-2 flex w-full flex-col justify-center">
  <h1>{content.title}</h1>
  <p>{content.description}</p>
  <p>Email: <a href={`mailto:${content.email}`}>{content.email}</a></p>
  {
    content.teachersContact.map((teacher) => (
      <div class="mt-4">
        <h3>{teacher.name}</h3>
        <p>
          Email: <a href={`mailto:${teacher.email}`}>{teacher.email}</a>
        </p>
        <p>
          Phone: <a href={`tel:${teacher.phone}`}>{teacher.phone}</a>
        </p>
      </div>
    ))
  }
  <p class="mt-4 mb-2">Address: {content.address}</p>
  <Map />
</div>
